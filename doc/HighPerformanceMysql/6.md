# 可扩展的MySQL

系统的真实容量定义为在可接受的性能的情况下能够达到的吞吐量，容量可以简单的认为是处理负载的能力。

可扩展性表示当需要增加资源以执行更多工作时系统化能够获得划算的等同提升。也就是可以通过添加资源来提升容量的能力。

- 数据量
- 用户量
- 用户活跃度
- 相关数据集的大小

## 扩展方式

### 向上扩展

也叫垂直扩展，意味着购买更多性能强悍的硬件资源。

有致命上限，且成本较高。

### 向外扩展

也叫水平扩展或者横向扩展。其基本策略就是复制，拆分以及数据分片。

最简单的也最常见的向外扩展的方式就是复制将数据分发到多个服务器上。

（若无必要，尽量不要分片）

无上限的主流做法。

### 多实例扩展

将数据分片设置的小一些，然后每台机器上放置多个分片，每台服务器上运行多个实例，然后划分服务器的资源，将其分配给每一个实例。硬件的最大使用效率。

### 向内扩展

处理不断增长的数据和负载最简单的方式就是对不再需要的数据进行归档和清理。

## 负载均衡

负载均衡的思路很简单，在一个服务器集群中尽可能地平衡负载量，通常的做法即在服务器前端设置一个负载均衡器，然后由负载均衡器将请求的连接路由到最空闲的可用服务器。

负载均衡的目的：

- 可扩展性：扩展某些策略时会有所帮助，比如读写分离
- 高效性：更好的利用服务器资源，如果服务器处理能力不同，则更为明显
- 可用性：使用心跳检测机制，剔除不可用的服务器
- 透明性：用户对负载均衡无感知
- 一致性：如果应用是有状态的，那么负载均衡就应该将相关的查询路由到同一台服务器

负载均衡算法：

- 随机
- 轮询
- 最少链接
- 最快响应
- 哈希
- 权重

一主多备间的负载均衡

- 功能分区
- 过滤和数据分区
- 将部分写操作转移到备库
- 保证备库跟上主库
- 同步写操作





